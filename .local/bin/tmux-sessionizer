#!/usr/bin/env bash

if [[ $# -eq 1 ]]; then
    selected="$1"
else
    additional_dirs="$HOME"
    selected=$(find ~/work ~/personal ~/onap ~/.config -mindepth 1 -maxdepth 1 -type d | printf "%s\n" "$(cat -)" "$additional_dirs" | fzf)
fi

if [[ -z $selected ]]; then
    exit 0
fi

selected_name=$(basename "$selected" | tr . _)

if [ -x "$(command -v tmux)" ] && [ -n "${DISPLAY}" ]; then
    tmux has -t "$selected_name" >/dev/null 2>&1 || tmux new -d -s "$selected_name" -c "$selected"
    tmux attach -t "$selected_name" >/dev/null 2>&1 || tmux switchc -t "$selected_name"
fi
